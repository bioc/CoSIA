---
title: "Introduction_to_CoSIA"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Introduction
Add an “Introduction” section that serves as an abstract to introduce the objective, models, unique functions, key points, etc that distinguish the package from other packages in the same area.
##Installation
Add an “Installation” section that show to users how to download and load the package from Bioconductor.
These instructions and any installations instructions should be in an eval=FALSE code chunk. No where in the code ( code, man pages, vignettes, Rmd files) should someone try to install or download system dependencies, applications, packages, etc. Developers can provide instructions to follow in unevaluated code chunks, and should assume all necessary dependencies, applications or packages are already set up on a user’s system.

##Table of Contents



```{r}
.libPaths("/data/user/anishah/4.1.0RInteractiveLibs/")
.libPaths()
FullHumanMDLKD <- read.csv("/data/user/anishah/Used_Case_CoSIA/scripts/outputs/FullHumanMDLKD.csv")
FullHumanMDLKD<- load("~/Downloads/FullHumanMDLKD.RData")
FullHumanMDLKD<-joined
library(devtools)
install_github("lasseignelab/CoSIA", ref= "main", auth_token = "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") 
library(CoSIA)
```


```{r}

#Human to Human
Test1 <- new("CosiaAnnotate", input = FullHumanMDLKD$Human_Symbol, input_species = "homo_sapiens", input_id = "Symbol", output_ids = c("ENSEMBL","ENTREZID"), output_species = "homo_sapiens", tool = "annotationDBI")
Output1<-getConversion(Test1)
head(Output1)
unique(Output1)
Db<-dplyr::sample_n(Output1, 20)
colnames(Db)[which(names(Db) == "SYMBOL")] <- paste("homo_sapiens_Symbol",sep="_") #rename to a more formal name


#Human to Mouse - AnnotationDBI
Test2 <- new("CosiaAnnotate", input = FullHumanMDLKD$Human_Symbol, input_species = "homo_sapiens", input_id = "Symbol", output_ids = c("Ensembl.id","Entrez.id"), output_species = "mus_musculus", tool = "annotationDBI", ortholog_database = "HomoloGene")
Output2<-getConversion(Test2)
head(Output2)

#Human to Mouse - BiomaRt
Test2 <- new("CosiaAnnotate", input = FullHumanMDLKD$Human_Symbol, input_species = "homo_sapiens", input_id = "Symbol", output_ids = c("Ensembl.id","Entrez.id"), output_species = "mus_musculus", tool = "biomaRt", ortholog_database = "HomoloGene")
Output2<-getConversion(Test2)
head(Output2)

#Human to Drosophila
Test3 <- new("CosiaAnnotate", input = FullHumanMDLKD$Human_Symbol, input_species = "homo_sapiens", input_id = "Symbol", output_ids = c("Ensembl.id","Entrez.id"), output_species = "d_melanogaster", tool = "annotationDBI", ortholog_database = "HomoloGene")
Output3<-getConversion(Test3)
head(Output3)
#d_melanogaster is not included in NCBIOrthoAnnotationPipe

#Human to Zebra Fish
Test4 <- new("CosiaAnnotate", input = FullHumanMDLKD$Human_Symbol, input_species = "homo_sapiens", input_id = "Symbol", output_ids = c("Ensembl.id","Entrez.id"), output_species = "danio_rerio", tool = "annotationDBI", ortholog_database = "NCBIOrthoAnnotationPipe")
Output4<-getConversion(Test4)
head(Output4)

#Human to Rat
Test5 <- new("CosiaAnnotate", input = FullHumanMDLKD$Human_Symbol, input_species = "homo_sapiens", input_id = "SYMBOL", output_ids = c("ENSEMBL","ENTREZID"), output_species = "r_norvegicus", tool = "annotationDBI", ortholog_database = "HomoloGene")
Output5<-getConversion(Test5)
head(Output5)

#Human to Celegans
Test6 <- new("CosiaAnnotate", input = FullHumanMDLKD$Human_Symbol, input_species = "homo_sapiens", input_id = "SYMBOL", output_ids = c("ENSEMBL","ENTREZID"), output_species = "c_elegans", tool = "annotationDBI", ortholog_database = "HomoloGene")
# NCBIOrtho does not include C.elegans
Output6<-getConversion(Test6)
head(Output6)

```


```{r}

Mouse <- new("CosiaAnnotate", input = Db$homo_sapiens_Symbol, input_species = "homo_sapiens", input_id = "SYMBOL", output_ids = c("ENTREZID","ENSEMBL","SYMBOL"), output_species = "mus_musculus", tool = "annotationDBI", ortholog_database = "HomoloGene")
Mouse_db<-getConversion(Mouse)

Rat <- new("CosiaAnnotate", input = Db$homo_sapiens_Symbol, input_species = "homo_sapiens", input_id = "SYMBOL", output_ids = c("ENTREZID","ENSEMBL","SYMBOL"), output_species = "r_norvegicus", tool = "annotationDBI", ortholog_database = "HomoloGene")
Rat_db<-getConversion(Rat)

merged_data<-merge.data.frame(data.frame(Db), data.frame(Mouse_db), by = "homo_sapiens_Symbol") #merge the two dataframes

merged_data_1<-merge.data.frame(data.frame(merged_data), data.frame(Rat_db), by = "homo_sapiens_Symbol")

zebrafish <- new("CosiaAnnotate", input = Db$homo_sapiens_Symbol, input_species = "homo_sapiens", input_id = "SYMBOL", output_ids = c("ENTREZID","ENSEMBL","SYMBOL"), output_species = "danio_rerio", tool = "annotationDBI", ortholog_database = "HomoloGene")
zebrafish_db<-getConversion(zebrafish)

merged_data_2<-merge.data.frame(data.frame(merged_data_1), data.frame(zebrafish_db), by = "homo_sapiens_Symbol")

gene_list<-data.frame(merged_data_2[6:13,])
saveRDS(gene_list, "/data/user/anishah/gene_list.rds")

```

```{r}
Mouse_expression <- new("CosiaExpressSpecies",list_of_ensembl_ids = c("ENSMUSG00000000182"), list_of_respective_species = c("Mus_musculus"), single_tissue = "kidney", pathToData = "/data/user/anishah/CoSIA/data/")

getSpeciesExpression(Mouse_expression)

Mouse_expression@dataframe

```

```{r}

SGO1_expression_across_tissues <- new("CosiaExpressSpecies",list_of_ensembl_ids = c("ENSMUSG00000023940", "ENSRNOG00000022499", "ENSDARG00000103907"), list_of_respective_species = c("mus_musculus", "rattus_norvegicus","danio_rerio"), single_tissue = "kidney")
getSpeciesExpression(SGO1_expression_across_tissues)



```

```{r}


```





